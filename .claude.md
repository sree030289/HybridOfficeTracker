# OfficeTrack - Hybrid Work Attendance Tracker

## Project Overview

**OfficeTrack** is a free, open-source hybrid work attendance tracking application built with React Native and Expo. It helps employees monitor their office vs. work-from-home patterns with minimal effort through automated location tracking or quick manual logging.

- **Type**: Cross-platform mobile app (iOS, Android, Web) + Marketing website
- **Version**: 2.2.1
- **Framework**: React Native with Expo
- **Backend**: Firebase Realtime Database
- **License**: Open Source

## Core Functionality

OfficeTrack enables users to:
- Track office attendance vs. work-from-home days
- Log attendance manually via notifications or automatically via GPS
- View attendance analytics (monthly, quarterly, yearly)
- Plan office days in advance with reminders
- Monitor progress toward monthly office attendance targets
- Automatically detect public holidays based on location

## Technology Stack

### Frontend
- **React 19.1.0** - Core UI library
- **React Native 0.81.5** - Mobile framework
- **React Native Web 0.21.0** - Web platform support
- **Expo 54.0.0** - Development platform and tooling

### Backend & Services
- **Firebase Realtime Database** - Cloud data storage and sync
- **Firebase Analytics** - Event tracking
- **AsyncStorage** - Local device storage for offline support

### Key Libraries
- **Expo Location (v19.0.7)** - GPS-based location tracking
- **Expo Notifications (v0.32.12)** - Push notifications and reminders
- **Expo Device** - Device information
- **Expo Print/Sharing** - Export and sharing functionality

## Project Structure

```
OfficeHybridTracker/
â”œâ”€â”€ App.js                          # Main React Native application (8,131 lines)
â”œâ”€â”€ firebase.config.js              # Firebase configuration
â”œâ”€â”€ database.rules.json             # Firebase security rules
â”œâ”€â”€ package.json                    # Dependencies and scripts
â”œâ”€â”€ app.json                        # Expo configuration
â”‚
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ firebaseService.js          # Firebase data operations with offline support
â”‚   â””â”€â”€ productionLogger.js         # Logging service with Firebase integration
â”‚
â”œâ”€â”€ web-dashboard/                  # Marketing website
â”‚   â”œâ”€â”€ index.html                  # Landing page
â”‚   â”œâ”€â”€ styles.css                  # Responsive styling
â”‚   â”œâ”€â”€ script.js                   # Interactive features
â”‚   â”œâ”€â”€ privacy.html                # Privacy policy
â”‚   â”œâ”€â”€ terms.html                  # Terms of service
â”‚   â”œâ”€â”€ contact.html                # Contact & FAQ
â”‚   â””â”€â”€ assets/                     # Screenshots and images
â”‚
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ icon.png                    # App icon
â”‚   â”œâ”€â”€ splash.png                  # Splash screen
â”‚   â””â”€â”€ notification_sound.wav      # Notification audio
â”‚
â””â”€â”€ Utility Scripts
    â”œâ”€â”€ check_existing_tokens.js    # Check Firebase for FCM tokens
    â””â”€â”€ send_update_notification.js # Send push notifications to users
```

## Key Components & Features

### 1. Main Application ([App.js](App.js))
The primary application file containing:
- Tab navigation with 4 screens: Home, Plan, Analytics, Settings
- Attendance tracking logic (manual and automatic modes)
- Location-based office detection (200m radius)
- Notification scheduling and handling
- Calendar interface with color-coded days
- Public holiday integration
- Statistics and analytics views

### 2. Firebase Service ([services/firebaseService.js](services/firebaseService.js))
Robust data persistence layer with:
- **getAllData()** - Fetch all user data from Firebase
- **updateData(path, value)** - Update specific data paths
- **cacheDataLocally()** - Local AsyncStorage backup
- **getLocalData()** - Fallback to cached data when offline
- **processSyncQueue()** - Handle queued updates for offline changes
- Real-time listeners for data synchronization

### 3. Production Logger ([services/productionLogger.js](services/productionLogger.js))
Comprehensive logging system:
- **info(message, context)** - Log information
- **error(message, error, context)** - Log errors with stack traces
- **event(eventName, params)** - Track user events
- **warning(message, context)** - Log warnings
- Device context capture (model, OS version, app version)
- Firebase Analytics integration

### 4. Tracking Modes

**Manual Mode (Recommended)**
- Receive 3 daily notifications: 10am, 1pm, 4pm
- Quick tap-to-log from notification
- No battery drain from location tracking
- Weekend-aware (no notifications on Sat/Sun)

**Auto Smart Detection**
- Hourly GPS location checks
- Automatic office detection within 200m radius
- Minimal battery impact
- Manual override capability

### 5. Database Structure

```
/users/{userId}/
  â”œâ”€â”€ attendanceData/           # {date: "office|wfh|leave"}
  â”œâ”€â”€ plannedDays/              # {date: "office|wfh|leave"}
  â”œâ”€â”€ userData/
  â”‚   â”œâ”€â”€ companyName
  â”‚   â”œâ”€â”€ companyAddress
  â”‚   â”œâ”€â”€ companyCoordinates
  â”‚   â”œâ”€â”€ trackingMode
  â”‚   â”œâ”€â”€ country
  â”‚   â””â”€â”€ userInfo
  â”œâ”€â”€ settings/
  â”‚   â”œâ”€â”€ monthlyTarget
  â”‚   â”œâ”€â”€ targetMode           # "days" or "percentage"
  â”‚   â””â”€â”€ preferences
  â”œâ”€â”€ cachedHolidays/           # {country_year: [dates]}
  â””â”€â”€ holidayLastUpdated/       # {country_year: timestamp}

/logs/{userId}/{logId}/
  â”œâ”€â”€ level                     # "error|warning|info"
  â”œâ”€â”€ message
  â””â”€â”€ timestamp
```

## Development Workflow

### Setup
```bash
# Install dependencies
npm install

# Configure Firebase
# Add your Firebase config to firebase.config.js

# Set up environment variables
cp .env.example .env.local
# Add your Firebase credentials
```

### Running the App
```bash
# Start development server
npm start

# Run on Android
npm run android

# Run on iOS
npm run ios

# Run web version
npm run web
```

### Building for Production
```bash
# Build for Android
eas build --platform android

# Build for iOS
eas build --platform ios

# Build for web
npx expo export:web
```

## Configuration Files

### [app.json](app.json)
Expo configuration including:
- App metadata (name, version, icon, splash)
- Platform-specific settings
- Permissions (location, notifications)
- Bundle identifiers
- Build configurations

### [firebase.config.js](firebase.config.js)
Firebase project configuration:
- API keys and project IDs
- Database URL
- Region: Asia Southeast 1 (Singapore)
- Services: Realtime Database, Auth, Analytics

### [database.rules.json](database.rules.json)
Firebase security rules:
- User data isolation (authenticated users only)
- Read/write permissions per data path
- Validation rules for data structure

## Key Features Implementation

### Location Tracking
- Implemented in [App.js:2800-3100](App.js#L2800-L3100)
- Uses Expo Location API
- Hourly background checks (not continuous)
- 200m office radius detection
- Low battery impact design

### Notification System
- Scheduled notifications in [App.js:3200-3500](App.js#L3200-L3500)
- Three daily reminders (10am, 1pm, 4pm) for manual mode
- 7am reminders for planned office days
- Weekend filtering logic
- Quick action handlers

### Public Holidays
- Holiday fetching in [App.js:4500-4800](App.js#L4500-L4800)
- Supports: Australia, India, USA, UK, Canada
- Smart caching with timestamp validation
- Year-based cache invalidation
- Offline availability via local cache

### Statistics & Analytics
- Analytics calculation in [App.js:5200-5600](App.js#L5200-L5600)
- Monthly, quarterly, yearly aggregations
- Target progress tracking
- Multiple view modes
- Color-coded visual representations

## Architecture Highlights

### Offline-First Design
- All data persists locally in AsyncStorage
- Firebase serves as cloud backup and sync
- App works fully offline
- Automatic sync when connection restored
- Queue-based update system

### Privacy-Focused
- No authentication required (dynamic user IDs)
- All location data stays on device
- Optional Firebase cloud sync
- No third-party tracking
- User data isolation in Firebase

### Performance Optimizations
- Holiday data caching
- Efficient React hooks usage
- Non-blocking background tasks
- Lazy loading for large datasets
- Asset optimization

## Color Coding System

The app uses color-coding throughout:
- ðŸŸ¢ Green (#10B981) - Office days
- ðŸ”µ Blue (#3B82F6) - Work from home
- ðŸŸ  Orange (#F59E0B) - Leave days
- ðŸ”´ Red (#EF4444) - Public holidays
- âšª Gray (#9CA3AF) - Weekends
- ðŸŸ¡ Light Green (#D1FAE5) - Planned office days

## Web Dashboard

Located in [web-dashboard/](web-dashboard/):
- Professional marketing website
- Modern black and orange theme
- Responsive mobile-first design
- App screenshots slideshow
- Download links (App Store, Google Play)
- Privacy policy and terms of service
- Contact and FAQ pages
- Firebase Analytics integration

## Utility Scripts

### [check_existing_tokens.js](check_existing_tokens.js)
Check Firebase for existing FCM notification tokens:
```bash
node check_existing_tokens.js
```

### [send_update_notification.js](send_update_notification.js)
Send push notifications to all users:
```bash
node send_update_notification.js
```

## Common Development Tasks

### Adding a New Screen
1. Create screen component in [App.js](App.js)
2. Add to tab navigator configuration
3. Update navigation types
4. Add screen-specific icons

### Modifying Attendance Logic
- Main logic: [App.js:1500-2000](App.js#L1500-L2000)
- Status updates: `updateAttendance()` function
- Firebase sync: Uses `firebaseService.updateData()`

### Changing Notification Schedule
- Notification config: [App.js:3200-3500](App.js#L3200-L3500)
- Modify `scheduleManualReminders()` function
- Update notification channels if needed

### Adding New Country for Holidays
1. Add country to settings picker
2. Update holiday API integration
3. Add country-specific logic in [App.js:4500-4800](App.js#L4500-L4800)
4. Test caching and display

### Modifying Color Theme
- Primary color: `#4F46E5` (Indigo)
- Update in [app.json](app.json)
- Search and replace color codes in [App.js](App.js)
- Update web dashboard [styles.css](web-dashboard/styles.css)

## Testing

### Manual Testing Checklist
- Test both tracking modes (manual and auto)
- Verify location detection accuracy
- Check notification delivery and timing
- Test offline functionality
- Verify Firebase sync after reconnection
- Test on both iOS and Android
- Validate holiday detection for all countries
- Check analytics calculations

### Debug Logging
The app includes comprehensive logging via [services/productionLogger.js](services/productionLogger.js):
- Check Firebase Console for logs
- Monitor Analytics events
- Review error reports

## Environment Variables

Create `.env.local` with:
```
FIREBASE_API_KEY=your_api_key
FIREBASE_AUTH_DOMAIN=your_auth_domain
FIREBASE_DATABASE_URL=your_database_url
FIREBASE_PROJECT_ID=your_project_id
FIREBASE_STORAGE_BUCKET=your_storage_bucket
FIREBASE_MESSAGING_SENDER_ID=your_sender_id
FIREBASE_APP_ID=your_app_id
```

## Known Issues & Limitations

- iOS background location requires "Always" permission
- Android requires exact alarm permission for reliable notifications
- Public holidays limited to 5 countries (AU, IN, US, UK, CA)
- Firebase free tier limits (10GB storage, 100 simultaneous connections)
- Web version has limited notification support

## Contributing Guidelines

When contributing to this project:
1. Maintain the offline-first architecture
2. Use the production logger for all logging
3. Test on both iOS and Android
4. Ensure Firebase sync works properly
5. Follow existing code style and patterns
6. Update this documentation for significant changes

## Resources

- **Expo Documentation**: https://docs.expo.dev/
- **React Native Docs**: https://reactnative.dev/
- **Firebase Docs**: https://firebase.google.com/docs
- **App Store**: (Add your link)
- **Google Play**: (Add your link)

## Support

For issues, feature requests, or questions:
- Check the [contact.html](web-dashboard/contact.html) FAQ section
- Review Firebase logs for errors
- Check device permissions for location and notifications

## Version History

- **v2.2.1** (Current) - Web support and dashboard improvements
- **v2.2.0** - Firebase integration and dependency updates
- **v2.1.0** - Enhanced UI and layout improvements
- **v2.0.0** - Major feature additions and refactoring

## License

This project is open source. See LICENSE file for details.
